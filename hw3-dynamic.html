<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Markup Masters</title>
        <link id="css-theme" rel="stylesheet" href="./hw3.css"/>
        <script>


            window.onload = function() {
                document.body.appendChild(createMain());
                var newDiv = document.createElement("div");
                newDiv.setAttribute("id", "soundboard");  //<div id="soundboard"></div>
    
                document.getElementsByTagName("main")[0].appendChild(newDiv);

                document.getElementById('soundboard').innerHTML = renderSoundBoard();
                document.body.appendChild(createFooter());
                sendRequest();
            };

            var compact = false;
            var soundTheme = 1;

            function changeSoundboard(n) {
                console.log(n);
                if (n == null) {
                    n = soundTheme;
                    compact = !compact;
                } else {
                    this.soundTheme = n;
                }
                console.log(n);
                console.log(compact);
                if(n==1) {
                    document.getElementById('soundboard').innerHTML = renderSoundBoard(true, compact);
                }
                else {
                    document.getElementById('soundboard').innerHTML = renderSoundBoard(false, compact);
                }
            }

            function renderSound(id,image,sound,name,compact) {
                var res;
                if (!compact) {
                    res = "<img src='assets/icons/" + image + "\'" +
                            " class='flex-item' onclick= 'play(\""+id+"\")' value='play'><audio id=" +
                            "\'" + id + "\' src='assets/sounds/" + sound + "\' type='audio/mpeg'></audio>";
                } else {
                    res = "<a class='dropcogalt'' onclick= 'play(\"" + id + "\")'>" + name + "</a><audio id='" + id + "' src='assets/sounds/" +
                            sound + "' type = 'audio/mpeg'></audio><br/>";
                }
                return res;
            }

            function renderMoviesSoundBoardAjax(soundboard) {
                var name = soundboard.name;
                var sounds = soundboard.sounds;
                var soundNames = ["Chewbacca", "Han Solo", "Darth Varder", "R2D2", "Starship Enterprise",
                        "Spock", "Rocket Ship", "Moon", "Ron Burgundy", "Ron Burgundy's Mustache", "Female Scarface",
                        "Scarface"];

                for (var i = 0; i < images.length; i++) {
                    if (i%4 == 0)
                        result = result + "<br><br>" + renderSound(sounds[i].name,sounds[i].image,sounds[i].audio, soundNames[i], compact);
                    else
                        result = result + renderSound(sounds[i].name,sounds[i].image,sounds[i].audio, soundNames[i], compact);
                }

                return result;


            }

            function renderSoundBoard(other, compact) {
                var result = "";
                var images;
                var sounds;
                var soundNames;
                if (other) {
                    images = ["hero1.png", "hero2.png", "hero3.png", "hero4.png",
                                  "hero5.png", "hero6.png", "hero7.png", "hero8.png", "hero9.png", 
                                  "hero10.png", "hero11.png", "hero12.png"];
                    sounds = ["avengers1.mp3","avengers2.mp3","avengers3.mp3",
                                                "avengers4.mp3","avengers5.mp3","avengers6.mp3",
                                                "avengers7.mp3","avengers8.mp3","avengers9.mp3",
                                                "avengers10.mp3","avengers11.mp3","avengers12.mp3"];
                    soundNames = ["Captain America", "Iron Man", "Thor", "Black Widow", "Nick Fury",
                        "The Incredible Hulk", "The Flash", "Green Lantern", "Wonder Woman", "Batman",
                        "Superman", "Aquaman"];
                }
                else {

                    images = ["chewyicon.png","han.png",
                                                "darthvadericon.png","r2d2.png",
                                                "enterpriseicon.png","spokicon.png",
                                                "rocketicon.jpg","moonicon.png","willferrelicon.png",
                                                "mustacheicon.jpg","scarfaceicon1.jpg",
                                                "scarfaceicon2.jpg"];
                    sounds = ["sw-theme.mp3","sw-badfeeling.mp3","sw-darthvader.mp3",
                                                "sw-r2d2.mp3","st-beammeaboard.mp3","st-consolebeeps.mp3",
                                                "st-interfacecomplete.mp3","st-intruderalert.mp3","anchorman1.mp3",
                                                "anchorman2.mp3","scarface1.mp3","scarface2.mp3"];
                    soundNames = ["Chewbacca", "Han Solo", "Darth Varder", "R2D2", "Starship Enterprise",
                        "Spock", "Rocket Ship", "Moon", "Ron Burgundy", "Ron Burgundy's Mustache", "Female Scarface",
                        "Scarface"];
                }          

                var ids = ["audio1","audio2","audio3","audio4","audio5","audio6","audio7","audio8","audio9","audio10",
                            "audio11","audio12"];

                for (var i = 0; i < images.length; i++) {
                    if (i%4 == 0)
                        result = result + "<br><br>" + renderSound(ids[i],images[i],sounds[i], soundNames[i], compact);
                    else
                        result = result + renderSound(ids[i],images[i],sounds[i], soundNames[i], compact);
                }
                return result;
            }

            var br = document.createElement("br");

            function createMain() {
                var node = document.createElement("main");
                node.appendChild(createHeader());
                var hr = document.createElement("hr");
                node.appendChild(hr);
                node.appendChild(createNavBar());
                node.appendChild(hr);
                node.appendChild(document.createElement("br"));
                node.appendChild(createForm());
                return node;
            }

            function createHeader() {
                var headerNode = document.createElement("header");
                var headerText = document.createTextNode("Soundboard");
                headerNode.appendChild(headerText);
                headerNode.appendChild(createGearDropdown());
                return headerNode;
            }



            function createGearDropdown() {
                var dropdown = document.createElement("div");
                dropdown.setAttribute("class", "dropdown");

                var gear = document.createElement("img");
                gear.setAttribute("src","./gears.svg");
                gear.setAttribute("onclick","dropdownFunc()");
                gear.setAttribute("class","dropcog");

                dropdown.appendChild(gear);// <img src="./gears.svg" onclick="dropdownFunc()" class="dropcog"></img>
                
                var innerDiv = document.createElement("div");

                innerDiv.setAttribute("id","dropdownItems");
                innerDiv.setAttribute("class","dropdownLinks");
                innerDiv.appendChild(createAnchor("#","Login"));
                innerDiv.appendChild(createAnchor("#","Sign Up"));
                innerDiv.appendChild(createAnchor("#","Upload"));
                innerDiv.appendChild(createAnchor("#","Dark Theme","changeTheme('./hw3-dark.css')"));
                innerDiv.appendChild(createAnchor("#","Light Theme","changeTheme('./hw3.css')"));
                innerDiv.appendChild(createAnchor("#","Superhero Soundboard","changeSoundboard(1)"));
                innerDiv.appendChild(createAnchor("#","Movies Soundboard","changeSoundboard(2)"));
                innerDiv.appendChild(createAnchor("#","Compact","changeSoundboard(null)"));

                dropdown.appendChild(innerDiv);

                return dropdown;

            }

            function createNavBar() {
                var navNode = document.createElement("nav");
                navNode.appendChild(createAnchor("https://b-b2dcd.firebaseapp.com/soundboard-part1a.html", "Plain Soundboard"));
                navNode.appendChild(createAnchor("https://b-b2dcd.firebaseapp.com/bootstrap-soundboard.html", "Bootstrap Soundboard"));
                navNode.appendChild(createAnchor("https://b-b2dcd.firebaseapp.com/index.html", "About Us"));
                return navNode;
            }

            function createAnchor(href, text, f) {
                var anchorNode = document.createElement("a");
                anchorNode.href = href;
                anchorNode.appendChild(document.createTextNode(text));

                if (f) {
                    anchorNode.setAttribute("onclick",f);

                }
                return anchorNode;
            }

            function createForm() {
                var formNode = document.createElement("form");
                formNode.appendChild(createBold("Email Address"));
                formNode.appendChild(br);
                formNode.appendChild(createInput("text", "email", "Enter Email"));
                formNode.appendChild(br);
                formNode.appendChild(createBold("Password"));
                formNode.appendChild(br);
                formNode.appendChild(createInput("text", "password", "Password"));
                formNode.appendChild(br); formNode.appendChild(br);
                formNode.appendChild(createLabel());
                formNode.appendChild(br); formNode.appendChild(br);
                formNode.appendChild(createButton());
                formNode.appendChild(br); formNode.appendChild(br); formNode.appendChild(br);
                return formNode;
            }

            function createBold(text) {
                var b = document.createElement("b");
                b.appendChild(document.createTextNode(text));
                return b;
            }

            function createInput(type, name, value) {
                var input = document.createElement("input");
                input.type = type;
                input.name = name;
                if (value != null) {
                    input.value = value;
                }
                return input;
            }

            function createLabel() {
                var label = document.createElement("label");
                label.appendChild(createInput("checkbox", "checkbox", null));
                label.appendChild(document.createTextNode(" Remember Me"));
                return label;
            }

            function createButton() {
                var button = document.createElement("button");
                button.appendChild(document.createTextNode("Submit"));
                return button;
            }

            function dropdownFunc() {
                document.getElementById("dropdownItems").classList.toggle("show");
            }   

            function changeTheme(theme) {
                document.getElementById("css-theme").href=theme;
            }



            function createFooter() {
                var footer  = document.createElement("footer");
                var text1 = document.createTextNode("Magdalena Ninette | Andy Thai | John Hurst");
                footer.appendChild(text1);
                footer.appendChild(document.createElement("br"));
                var text2 = document.createTextNode("CSE 134B");
                footer.appendChild(text2);
                footer.appendChild(document.createElement("br"));
                var text3 = document.createTextNode("Summer 2017");
                footer.appendChild(text3);

                return footer;
            }

            function play(audioId){
                var audio = document.getElementById(audioId);
                if (audio.paused) {
                    console.log("audio paused")
                    audio.play();
                } else {
                    audio.pause();
                }
            }

            function createXHR()
            {
               try { return new XMLHttpRequest(); } catch(e) {}
               try { return new ActiveXObject("Msxml2.XMLHTTP.6.0"); } catch (e) {}
               try { return new ActiveXObject("Msxml2.XMLHTTP.3.0"); } catch (e) {}
               try { return new ActiveXObject("Msxml2.XMLHTTP"); } catch (e) {}
               try { return new ActiveXObject("Microsoft.XMLHTTP"); } catch (e) {}
               
               alert("XMLHttpRequest not supported");   
               return null;
            }
 
            function sendRequest()
            {
                var xhr = createXHR();
             
                if (xhr)
                 {  //address?
                   xhr.open("GET","packet.json",true);
                  xhr.onreadystatechange = function(){handleResponse(xhr);};
                  xhr.send(null);
                 }
            }
             
            function handleResponse(xhr)
            {
              if (xhr.readyState == 4  && xhr.status == 200)
                {
                 var parsedResponse = xhr.responseXML;
                 var soundboardObj = JSON.parse(xhr.responseText);
                 //var msg = parsedResponse.getElementsByTagName('message')[0].firstChild.nodeValue;
                 //var responseOutput = document.getElementById("soundboard");
                 document.getElementById('soundboard').innerHTML = renderMoviesSoundBoardAjax();
                }
            }

        </script>
    </head>
    <body>
        <noscript>

        </noscript>
    </body>
</html>











